{"ast":null,"code":"var _jsxFileName = \"/Users/tainguyen/Desktop/my-app/src/components/Homepage.js\";\nimport Header from \"./Header\";\nimport PropTypes from \"prop-types\";\nimport React, { Component } from \"react\";\nimport PostInfo from \"./PostInfo\";\nimport { Link } from \"react-router-dom\";\nimport axios from 'axios';\nimport constants from '../constants.json';\nexport default class HomePage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {};\n\n    this._handleSignInClick = () => {\n      // Authenticate using via passport api in the backend\n      // Open Twitter login page\n      // Upon successful login, a cookie session will be stored in the client\n      window.open(\"http://localhost:4000/auth/google\", \"_self\");\n    };\n\n    this._handleLogoutClick = () => {\n      // Logout using Twitter passport api\n      // Set authenticated state to false in the HomePage\n      window.open(\"http://localhost:4000/auth/logout\", \"_self\");\n      this.setState({\n        authenticated: false\n      });\n    };\n\n    this.state = {\n      user: {},\n      error: null,\n      authenticated: false,\n      post: []\n    };\n  }\n\n  componentDidMount() {\n    axios.get(constants.baseAddress + \"/post\").then(res => {\n      console.log(res.data);\n      this.setState({\n        post: res.data\n      });\n    }).catch(error => console.log(error)); // Fetch does not send cookies. So you should add credentials: 'include'\n\n    fetch(\"http://localhost:4000/auth/login/success\", {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        \"Access-Control-Allow-Credentials\": true\n      }\n    }).then(response => {\n      if (response.status === 200) return response.json();\n      throw new Error(\"failed to authenticate user\");\n    }).then(responseJson => {\n      this.setState({\n        authenticated: true,\n        user: responseJson.user\n      });\n    }).catch(error => {\n      this.setState({\n        authenticated: false,\n        error: \"Failed to authenticate user\"\n      });\n    });\n  }\n\n  render() {\n    const {\n      authenticated\n    } = this.state;\n    console.log(this.state.authenticated);\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, \"Home\")), authenticated ? React.createElement(\"li\", {\n      onClick: this._handleLogoutClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, \"Logout\") : React.createElement(\"li\", {\n      onClick: this._handleSignInClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, \"Login\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, !authenticated ? React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, \"Welcome!\") : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, \"You have login succcessfully!\"))));\n  }\n\n}","map":{"version":3,"sources":["/Users/tainguyen/Desktop/my-app/src/components/Homepage.js"],"names":["Header","PropTypes","React","Component","PostInfo","Link","axios","constants","HomePage","constructor","props","componentDidMount","_handleSignInClick","window","open","_handleLogoutClick","setState","authenticated","state","user","error","post","get","baseAddress","then","res","console","log","data","catch","fetch","method","credentials","headers","Accept","response","status","json","Error","responseJson","render"],"mappings":"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","sourcesContent":["import Header from \"./Header\";\nimport PropTypes from \"prop-types\";\nimport React, { Component } from \"react\";\nimport PostInfo from \"./PostInfo\"\nimport { Link } from \"react-router-dom\";\nimport axios from 'axios';\nimport constants from '../constants.json';\nexport default class HomePage extends Component {\n \n    constructor(props)\n  {\n    super(props);\n    this.state = {\n      user: {},\n      error: null,\n      authenticated: false,\n      post: [],\n    };\n  } \n\n  componentDidMount = () => {\n    \n  }\n\n  componentDidMount() {\n    axios.get(constants.baseAddress + \"/post\")\n      .then(res => {\n        console.log(res.data);\n        this.setState({ post: res.data });\n      })\n      .catch(error => console.log(error));\n    // Fetch does not send cookies. So you should add credentials: 'include'\n    fetch(\"http://localhost:4000/auth/login/success\", {\n      method: \"GET\",\n      credentials: \"include\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        \"Access-Control-Allow-Credentials\": true\n      }\n    })\n      .then(response => {\n        if (response.status === 200) return response.json();\n        throw new Error(\"failed to authenticate user\");\n      })\n      .then(responseJson => {\n        this.setState({\n          authenticated: true,\n          user: responseJson.user\n        });\n      })\n      .catch(error => {\n        this.setState({\n          authenticated: false,\n          error: \"Failed to authenticate user\"\n        });\n      });\n  }\n\n  _handleSignInClick = () => {\n    // Authenticate using via passport api in the backend\n    // Open Twitter login page\n    // Upon successful login, a cookie session will be stored in the client\n    window.open(\"http://localhost:4000/auth/google\", \"_self\");\n  };\n\n  _handleLogoutClick = () => {\n    // Logout using Twitter passport api\n    // Set authenticated state to false in the HomePage\n    window.open(\"http://localhost:4000/auth/logout\", \"_self\");\n    this.setState({ authenticated: false });\n  };\n\n  render() {\n    const { authenticated } = this.state;\n    console.log(this.state.authenticated);\n    return (\n      <div>\n        <ul className=\"menu\">\n        <li>\n          <Link to=\"/\">Home</Link>\n        </li>\n        {authenticated ? (\n          <li onClick={this._handleLogoutClick}>Logout</li>\n        ) : (\n          <li onClick={this._handleSignInClick}>Login</li>\n        )}\n        </ul>\n        <div>\n          {!authenticated ? (\n            <h1>Welcome!</h1>\n          ) : (\n            <div>\n              <h1>You have login succcessfully!</h1>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n \n\n}\n\n\n"]},"metadata":{},"sourceType":"module"}